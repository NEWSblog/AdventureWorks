

--1. The new head of HR wants to know the first and last names of all employees in the Sales department.
SELECT PP.FirstName,PP.LastName,HD.Name Department
FROM Person.Person PP
LEFT JOIN HumanResources.EmployeeDepartmentHistory HED ON PP.BusinessEntityID = HED.BusinessEntityID
LEFT JOIN HumanResources.Department HD ON HED.DepartmentID = HD.DepartmentID
WHERE HD.Name = 'Sales'



--2.The CEO wants to have the product ID and sum of the top 10 products with sales lower than 700,000 and greater than 500,000.
SELECT TOP 10
    ProductID,
    sum(LineTotal) totalsales
FROM 
    Sales.SalesOrderDetail
GROUP BY 
    productid
HAVING 
    sum(LineTotal) < 700000 AND sum(LineTotal) > 500000
ORDER BY 
    sum(LineTotal);


---3. After the sales manager received the list of the product IDs with sales lower than 700,000 and greater than 500,000, they asked for the names of the products.

    SELECT PP.Name, TotalSales
FROM (
    SELECT 
        ProductID, 
        SUM(LineTotal) AS TotalSales
    FROM 
        Sales.SalesOrderDetail
    GROUP BY 
        ProductID
    HAVING 
        SUM(LineTotal) < 700000 AND SUM(LineTotal) > 500000
) AS SalesSummary
LEFT JOIN Production.Product PP ON SalesSummary.ProductID = PP.ProductID
ORDER BY TotalSales;





--4. The Marketing team would like to know the top 10 lowest & highest-priced products to determine which products need promotion.
-- Lowest priced products
SELECT TOP 10 PP.Name ProductName, SO.UnitPrice
FROM Sales.SalesOrderDetail SO
LEFT JOIN Production.Product PP ON SO.ProductID = PP.ProductID
ORDER BY SO.UnitPrice;

-- Highest priced products
SELECT TOP 10 PP.Name  ProductName, SO.UnitPrice
FROM Sales.SalesOrderDetail SO
LEFT JOIN Production.Product PP ON SO.ProductID = PP.ProductID
ORDER BY SO.UnitPrice DESC;


--5. HR wants to evaluate the performance of the sales representatives, so they are asking for the total sales amount for each salesperson last year.
SELECT PP.FirstName + ' ' + PP.LastName FullName,SP.SalesLastYear
FROM Sales.SalesPerson SP
LEFT JOIN Person.Person PP ON SP.BusinessEntityID = PP.BusinessEntityID

--6. The Sales manager wants to know the  number of orders placed by each customer, their firstname and their customer id.
SELECT PP.FirstName,SC.CustomerID,COUNT (SC.CustomerID) NoOfOrders
FROM Sales.SalesOrderDetail SOD
LEFT JOIN Sales.SalesOrderHeader SSO ON SOD.SalesOrderID = SSO.SalesOrderID
LEFT JOIN Sales.Customer SC ON SSO.CustomerID =SC.CustomerID
LEFT JOIN Person.Person PP ON   SC.PersonID =PP.BusinessEntityID      
GROUP BY SC.CustomerID,PP.FirstName


--7. The Sales manager also wants to know the total revenue generated by each product category.
SELECT  PPC.Name,SUM(SSOD.LineTotal)
FROM Production.ProductCategory PPC
LEFT JOIN Production.ProductSubcategory PPS ON PPC.ProductCategoryID = PPS.ProductSubcategoryID
LEFT JOIN Production.Product PP ON PPS.ProductSubcategoryID = PP.ProductSubcategoryID
LEFT JOIN Sales.SalesOrderDetail SSOD ON PP.ProductID = SSOD.ProductID
GROUP BY PPC.Name


--8. List the unique job titles in the Oranisation DataBase table.
SELECT DISTINCT JobTitle
FROM HumanResources.Employee


--9. The manager wants to send an email to all employees, so they have asked for the names and email addresses of all employees.
SELECT PP.FirstName, PP.LastName,PEA.EmailAddress
FROM HumanResources.Employee HRE
LEFT JOIN Person.Person PP ON HRE.BusinessEntityID = PP.BusinessEntityID
LEFT JOIN Person.EmailAddress PEA ON HRE.BusinessEntityID = PEA.BusinessEntityID


--10. After that, the manager wants to know the number of employees in each department.
SELECT HRD.Name Department,COUNT(HRE.BusinessEntityID) NoOfEmployee
FROM HumanResources.Department HRD
LEFT JOIN HumanResources.EmployeeDepartmentHistory HREDH ON HRD.DepartmentID = HREDH.DepartmentID
LEFT JOIN HumanResources.Employee HRE ON HREDH.BusinessEntityID = HRE.BusinessEntityID
GROUP BY HRD.Name


--11. Retrieve the phone numbers of all employees.
SELECT PP.FirstName, PP.LastName,PPP.PhoneNumber
FROM HumanResources.Employee HRE
LEFT JOIN Person.Person PP ON HRE.BusinessEntityID = PP.BusinessEntityID
LEFT JOIN Person.PersonPhone PPP ON HRE.BusinessEntityID = PPP.BusinessEntityID


--12. Find the number of products in each subcategory.
SELECT PPS.Name SubCategory,COUNT(PP.Name) NoOfProd
FROM Production.ProductSubcategory PPS
LEFT JOIN Production.Product PP ON PPS.ProductSubcategoryID = PP.ProductSubcategoryID
GROUP BY PPS.Name

--13. They also want to know the total number of orders in the SalesOrderHeader table.
	SELECT COUNT(OrderQTY) NoOfOrders
	FROM Sales.SalesOrderDetail


--14. Get the total quantity sold for each product.
SELECT PP.Name ,SUM(SSD.ORDERQTY) QTYSold
FROM  Production.Product PP
RIGHT JOIN Sales.SalesOrderDetail SSD ON PP.ProductID = SSD.ProductID
GROUP BY PP.Name



--15. The manager wants to know the total revenue for each sales territory .
SELECT SST.Name Territory,SUM(SSD.LineTotal) Revenue
FROM Sales.SalesTerritory SST
LEFT JOIN Sales.SalesOrderHeader SSH ON SST.TerritoryID =SSH.TerritoryID
LEFT JOIN Sales.SalesOrderDetail SSD ON SSH.SalesOrderID = SSD.SalesOrderID
GROUP BY SST.Name





